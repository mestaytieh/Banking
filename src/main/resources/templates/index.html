<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="components/header :: header"></head>

<body>
<nav th:replace="components/top-nav :: nav-after-log"></nav>


<!-- Page Content -->
<div class="container">
    <div class="row">
        <div class="col-lg-12 text-center">
            <h1 class="mt-5">Online Banking</h1>
            <p class="lead">Create Accounts</p>
        </div>
    </div>
    <div class="row">
        <div class="col-md-3"></div>
        <div class="col-md-6">
            <div class="panel panel-default">
                <div class="panel-heading"><h3 class="panel-title"><strong>User</strong></h3></div>
                <div class="panel-body">
                    <br/>
                    <input type="text" id = "customerIdField" class="form-control p-3" />
                    <button type="button" class="btn btn-success" onclick="getUserInfo()" value="Get User"><span class="glyphicon glyphicon-user"></span> Get User </button>
                    <div class="panel-body" id="UserInfo">
                        <label>Name: </label> <b id ="First_Name"></b> <br/>
                        <label>Surname: </label> <b id ="Sur_Name"></b> <br/>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3"></div>
    </div>
    <div class="row">
        <div class="col-md-3"></div>
        <div class="col-md-6">
            <div class="panel panel-default">
                <div class="panel-heading"><h3 class="panel-title"><strong>Account</strong></h3></div>
                <div class="panel-body">


                            <!-- Modal content-->
<!--                                    <form th:object="${createAccountForm}" th:action="@{/addAccount}" method="post">-->
<!--                                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>-->


                                        <div class="form-group">
                                            <label>Customer Id</label>
                                            <input type="text" class="form-control" id="customerId"
                                                   name="customerId" placeholder="Receiver IBAN" required>
                                        </div>

                                        <div class="form-group">
                                            <label>Initial Credit</label>
                                            <input type="number" class="form-control" id="initialCredit"
                                                   name="credit" placeholder="credit" required>
                                        </div>
                                        <button id="addBtn" type="button" onclick="createAccount()" class="btn btn-md btn-primary btn-block">Create Account</button>
<!--                                    </form>-->


                    <br/>
                </div>
            </div>
        </div>
        <div class="col-md-3"></div>
    </div>
</div>



<!-- Bootstrap core JavaScript -->

</body>

</html>
<script type="text/javascript">
    function getUserInfo()
    {
            var customerId = $("#customerIdField").val();
            $.get("api/userinfo/userbyCustomerId/"+customerId,function(response) {
                console.log("userbyCustomerId", response)
                if(response != undefined) {
                    $("#First_Name").text(response.firstName);
                    $("#Sur_Name").text(response.surName);

                    alert("success");
                } else {
                    alert("CustomerId Not Found");
                }
            });
    }

    function createAccount()
    {
        var customerId = $("#customerId").val();
        var initialCredit = $("#initialCredit").val();
        $.post("api/accounts/addAccount",
            {
                customerId: "Donald Duck",
                city: "initialCredit"
            },
            function(data, status){
                alert("Data: " + data + "\nStatus: " + status);
            });
    }

    function createAccount2()
    {
        var customerId = $("#customerId").val();
        var initialCredit = $("#initialCredit").val();
        $.post("api/accounts/addAccount2",
            {
                customerId: "Donald Duck",
                city: "initialCredit"
            },
            function(data, status){
                alert("Data: " + data + "\nStatus: " + status);
            });
    }

    function createAccount3()
    {
        var customerId = $("#customerId").val();
        var initialCredit = $("#initialCredit").val();
        $.post("api/accounts/saveData",
            {
                customerId: "Donald Duck",
                city: "initialCredit"
            },
            function(data, status){
                alert("Data: " + data + "\nStatus: " + status);
            });
    }
    function createAccount4() {
        $.ajax({
            url: 'api/accounts/createAcount',
            dataType: 'jsonp',
            type: 'post',
            cors: false ,
            contentType: 'application/json',
            data: JSON.stringify({"customerId": $('#customerId').val(), "initialCredit": $('#initialCredit').val()}),
            processData: false,
            secure: true,
            success: function (data, textStatus, jQxhr) {
                console.log("JSON.stringify(data)",JSON.stringify(data));
                $('#response pre').html(JSON.stringify(data));
            },
            error: function (jqXhr, textStatus, errorThrown) {
                console.log(errorThrown);
            }
        });

    }

</script>